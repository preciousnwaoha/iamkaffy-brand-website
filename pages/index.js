import Head from "next/head";
// import Cookies from "js-cookie";
import CookieConsent, { Cookies, getCookieConsentValue } from "react-cookie-consent";
import Services from "../components/Services/Services";
import SuccessStories from "../components/Impact/SuccessStories";
import GetInTouch from "../components/Contact/GetInTouch";
import Story from "../components/About/Story";
import Footer from "../components/Layout/Footer";
import Header from "../components/Layout/Header";
import Landing from "../components/Landing";
import VaultVideos from "../components/Vault/VaultVideos";
import BrandsWorkedWith from "../components/Expressions/BrandsWorkedWith";
import Feature from "../components/Featured/Feature";
import Effect3 from "../components/UI/Effects/Effect3";
import styles from "../styles/Home.module.css";

import { db } from "../firebase";
import { collection, getDocs } from "firebase/firestore";

// const videosCollectionRef = collection(db, "videos")
const contactDetailsCollectionRef = collection(db, "contactDetails");
const successStoriesCollectionRef = collection(db, "successStories");
const featuredCollectionRef = collection(db, "featured");

export async function getStaticProps() {
  // const videosDataFrb = await getDocs(videosCollectionRef);

  const contactDetailsData = await getDocs(contactDetailsCollectionRef);
  const successStoriesData = await getDocs(successStoriesCollectionRef);
  const featuredDataFrb = await getDocs(featuredCollectionRef);


  // const videosData = videosEmbedIdData.docs.map(doc =>  {
  //   return (
  //     {...doc.data(), id: doc.id}
  //   )
  // })

  const featuredData = featuredDataFrb.docs.map((doc) => {
    return { ...doc.data(), id: doc.id };
  });


  const videosData = [
    { id: "Yq99FyfnGxA", type: "landscape", from: "youtube" },
    { id: "41FLPJ5_Qwk", type: "portrait", from: "youtube" },
  ];

  const contactDetails = contactDetailsData.docs.map((doc) => {
    return { ...doc.data(), id: doc.id };
  });

  const successStories = successStoriesData.docs.map((doc) => {
    return { ...doc.data(), id: doc.id };
  });

  return {
    props: {
      videosData,
      contactDetails,
      successStories,
      featuredData,
    },
  };
}

export default function Home({
  featuredData,
  videosData,
  successStories,
  contactDetails,
}) {

  return (
    <div className={styles.container}>
      <Head>
        <title>Kaffy Brand</title>
        <meta name="description" content="Generated by create next app" />
      </Head>

      <main className={styles.main}>
        <Header />
        <Landing />
        <div style={{ position: "relative" }}>
          <Effect3 className={styles["effect-item"]} />
          <Feature feature={featuredData[0]} />
        </div>

        <SuccessStories successStories={successStories} />
        <Story />
        <VaultVideos videosData={videosData} />
        <Services inHome={true} />
        <BrandsWorkedWith />
        <GetInTouch data={contactDetails} />
        <CookieConsent
        // debug={true}
        location="bottom"
        containerClasses={styles["cookie-consent-container"]}
        contentClasses={styles["cookie-consent-content"]}
        buttonClasses={styles["cookie-consent-btn"]}
        expires={365}
          >
          We use cookies to enhance your experience as you use this website.{" "}
          {/* <span style={{ fontSize: "0.85rem" }}>
            This bit of text is smaller :O
          </span> */}
        </CookieConsent>
        {console.log(getCookieConsentValue())}
      </main>
      <Footer />
    </div>
  );
}
